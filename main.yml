---
version: "1.0"

steps:
  # Version control
  - include: ./git/main.yml
    tags: [core, git]

  # Programming languages - Using Presets
  - name: Install Python via pyenv
    preset: python
    with:
      version: "3.12.12"
      install_virtualenv: true
    tags: [dev, python]

  - name: Install Rust toolchain
    preset: rust
    with:
      toolchain: stable
      profile: default
    tags: [dev, rust]

  # Node.js already installed manually (v22.22.0)
  # - name: Install Node.js via nvm
  #   preset: nodejs
  #   with:
  #     version: "22"
  #     global_packages:
  #       - webpack
  #       - eslint
  #       - prettier
  #   tags: [dev, node]

  # Modern Unix tools
  # TODO: modern-unix preset has issues with templated state parameter
  # - name: Install modern Unix tools
  #   preset: modern-unix
  #   with:
  #     tools:
  #       - bat        # cat with syntax highlighting
  #       - exa        # ls replacement
  #       - zoxide     # smart cd
  #       - dust       # du replacement
  #       - duf        # df replacement
  #       - bottom     # top/htop replacement
  #   tags: [tools, modern-unix]

  - name: Install Go toolchain
    preset: go
    with:
      version: "latest"
      gopath: "{{ GOPATH }}"
    tags: [dev, golang]

  # Other languages
  - name: Install Java JDK
    preset: java
    with:
      version: "21"
      set_java_home: true
    tags: [dev, java]

  - name: Install Clojure
    preset: clojure
    tags: [dev, clojure]

  - name: Deploy Clojure configs
    include: ./clojure/config.yml
    tags: [dev, clojure, config]

  # Terminal tools
  - name: Install fzf fuzzy finder
    preset: fzf
    with:
      install_shell_extensions: true
      install_vim_plugin: false
    tags: [tools, fzf]

  - include: ./zsh/main.yml
    tags: [core, shell]

  # Tmux - using custom installation due to preset template issue
  - include: ./tmux/install.yml
    tags: [tools, tmux]

  - name: Deploy tmux config
    include: ./tmux/config.yml
    tags: [tools, tmux, config]

  # Editors
  - include: ./nvim/main.yml
    tags: [editor, nvim]

  # macOS specific
  # Note: Install Alacritty via Homebrew cask: brew install --cask alacritty
  - name: Deploy Alacritty config
    include: ./alacritty/config.yml
    when: os == "darwin"
    tags: [macos, terminal, config]

  - include: ./macos/main.yml
    when: os == "darwin"
    tags: [macos]
