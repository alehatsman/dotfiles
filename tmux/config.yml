---
# Tmux configuration deployment (installation handled by preset)

- name: Create tmux config directory
  file:
    path: ~/.config/tmux
    state: directory
  tags: [tmux, config]

- name: Create tmux plugins directory
  file:
    path: ~/.config/tmux/plugins
    state: directory
  tags: [tmux, config]

- name: Backup existing .tmux.conf
  shell: |
    if [ -f ~/.tmux.conf ]; then
      mkdir -p ~/.dotfiles-backup
      cp ~/.tmux.conf ~/.dotfiles-backup/.tmux.conf.$(date +%Y%m%d_%H%M%S)
    fi
  tags: [tmux, backup]

- name: Deploy .tmux.conf
  template:
    src: ./.tmux.conf.j2
    dest: ~/.tmux.conf
  tags: [tmux, config]

- name: Verify tmux config
  assert:
    command:
      cmd: test -f ~/.tmux.conf
  tags: [tmux, verify]

- name: Verify tpm installation
  assert:
    command:
      cmd: test -d ~/.config/tmux/plugins/tpm
  tags: [tmux, verify]
